<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitel 6 Sannolikhetsfördelningar och slumptal | R-anvisningar till Grundläggande statistik</title>
  <meta name="description" content="Kapitel 6 Sannolikhetsfördelningar och slumptal | R-anvisningar till Grundläggande statistik" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitel 6 Sannolikhetsfördelningar och slumptal | R-anvisningar till Grundläggande statistik" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitel 6 Sannolikhetsfördelningar och slumptal | R-anvisningar till Grundläggande statistik" />
  
  
  



<meta name="date" content="2022-05-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="beskrivande-statistik.html"/>
<link rel="next" href="ett-stickprov.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R-anvisningar</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduktion</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="installation.html"><a href="installation.html#inledning"><i class="fa fa-check"></i><b>2.1</b> Inledning</a></li>
<li class="chapter" data-level="2.2" data-path="installation.html"><a href="installation.html#installation-av-r"><i class="fa fa-check"></i><b>2.2</b> Installation av R</a></li>
<li class="chapter" data-level="2.3" data-path="installation.html"><a href="installation.html#installation-av-rstudio"><i class="fa fa-check"></i><b>2.3</b> Installation av RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="installation.html"><a href="installation.html#gränssnittet-i-rstudio"><i class="fa fa-check"></i><b>2.4</b> Gränssnittet i RStudio</a></li>
<li class="chapter" data-level="2.5" data-path="installation.html"><a href="installation.html#paket-i-r"><i class="fa fa-check"></i><b>2.5</b> Paket i R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="objekt-och-funktioner.html"><a href="objekt-och-funktioner.html"><i class="fa fa-check"></i><b>3</b> Objekt och funktioner</a>
<ul>
<li class="chapter" data-level="3.1" data-path="objekt-och-funktioner.html"><a href="objekt-och-funktioner.html#sekvenser-av-funktioner"><i class="fa fa-check"></i><b>3.1</b> Sekvenser av funktioner</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dataimport.html"><a href="dataimport.html"><i class="fa fa-check"></i><b>4</b> Dataimport</a>
<ul>
<li class="chapter" data-level="4.1" data-path="dataimport.html"><a href="dataimport.html#direkt-inskrivning-av-data"><i class="fa fa-check"></i><b>4.1</b> Direkt inskrivning av data</a></li>
<li class="chapter" data-level="4.2" data-path="dataimport.html"><a href="dataimport.html#import-från-en-extern-fil"><i class="fa fa-check"></i><b>4.2</b> Import från en extern fil</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html"><i class="fa fa-check"></i><b>5</b> Beskrivande statistik</a>
<ul>
<li class="chapter" data-level="5.1" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#datamängd"><i class="fa fa-check"></i><b>5.1</b> Datamängd</a></li>
<li class="chapter" data-level="5.2" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#filtrering-av-rader-och-selektion-av-kolumner"><i class="fa fa-check"></i><b>5.2</b> Filtrering av rader och selektion av kolumner</a></li>
<li class="chapter" data-level="5.3" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#transformationer-av-variabler"><i class="fa fa-check"></i><b>5.3</b> Transformationer av variabler</a></li>
<li class="chapter" data-level="5.4" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#sammanfattande-statistik"><i class="fa fa-check"></i><b>5.4</b> Sammanfattande statistik</a></li>
<li class="chapter" data-level="5.5" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#grafer"><i class="fa fa-check"></i><b>5.5</b> Grafer</a></li>
<li class="chapter" data-level="5.6" data-path="beskrivande-statistik.html"><a href="beskrivande-statistik.html#övningar"><i class="fa fa-check"></i><b>5.6</b> Övningar</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sannolikhetsfördelningar-och-slumptal.html"><a href="sannolikhetsfördelningar-och-slumptal.html"><i class="fa fa-check"></i><b>6</b> Sannolikhetsfördelningar och slumptal</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sannolikhetsfördelningar-och-slumptal.html"><a href="sannolikhetsfördelningar-och-slumptal.html#fördelningar"><i class="fa fa-check"></i><b>6.1</b> Fördelningar</a></li>
<li class="chapter" data-level="6.2" data-path="sannolikhetsfördelningar-och-slumptal.html"><a href="sannolikhetsfördelningar-och-slumptal.html#egna-funktioner"><i class="fa fa-check"></i><b>6.2</b> Egna funktioner</a></li>
<li class="chapter" data-level="6.3" data-path="sannolikhetsfördelningar-och-slumptal.html"><a href="sannolikhetsfördelningar-och-slumptal.html#simuleringar"><i class="fa fa-check"></i><b>6.3</b> Simuleringar</a></li>
<li class="chapter" data-level="6.4" data-path="sannolikhetsfördelningar-och-slumptal.html"><a href="sannolikhetsfördelningar-och-slumptal.html#övningar-1"><i class="fa fa-check"></i><b>6.4</b> Övningar</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ett-stickprov.html"><a href="ett-stickprov.html"><i class="fa fa-check"></i><b>7</b> Ett stickprov</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ett-stickprov.html"><a href="ett-stickprov.html#normalfördelad-data-eller-stora-stickprov"><i class="fa fa-check"></i><b>7.1</b> Normalfördelad data (eller stora stickprov)</a></li>
<li class="chapter" data-level="7.2" data-path="ett-stickprov.html"><a href="ett-stickprov.html#binär-data.-proportioner"><i class="fa fa-check"></i><b>7.2</b> Binär data. Proportioner</a></li>
<li class="chapter" data-level="7.3" data-path="ett-stickprov.html"><a href="ett-stickprov.html#nominal-eller-ordinal-data.-goodness-of-fit"><i class="fa fa-check"></i><b>7.3</b> Nominal eller ordinal data. Goodness-of-fit</a></li>
<li class="chapter" data-level="7.4" data-path="ett-stickprov.html"><a href="ett-stickprov.html#övningar-2"><i class="fa fa-check"></i><b>7.4</b> Övningar</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="två-stickprov.html"><a href="två-stickprov.html"><i class="fa fa-check"></i><b>8</b> Två stickprov</a>
<ul>
<li class="chapter" data-level="8.1" data-path="två-stickprov.html"><a href="två-stickprov.html#normalfördelad-data-eller-stora-stickprov-1"><i class="fa fa-check"></i><b>8.1</b> Normalfördelad data (eller stora stickprov)</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="två-stickprov.html"><a href="två-stickprov.html#t-test-för-två-matchade-stickprov"><i class="fa fa-check"></i><b>8.1.1</b> t-test för två matchade stickprov</a></li>
<li class="chapter" data-level="8.1.2" data-path="två-stickprov.html"><a href="två-stickprov.html#t-test-för-två-oberoende-stickprov"><i class="fa fa-check"></i><b>8.1.2</b> t-test för två oberoende stickprov</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="två-stickprov.html"><a href="två-stickprov.html#binär-data.-proportioner-1"><i class="fa fa-check"></i><b>8.2</b> Binär data. Proportioner</a></li>
<li class="chapter" data-level="8.3" data-path="två-stickprov.html"><a href="två-stickprov.html#nominal-eller-ordinal-data.-korstabeller"><i class="fa fa-check"></i><b>8.3</b> Nominal eller ordinal data. Korstabeller</a></li>
<li class="chapter" data-level="8.4" data-path="två-stickprov.html"><a href="två-stickprov.html#övningar-3"><i class="fa fa-check"></i><b>8.4</b> Övningar</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="variansanalys.html"><a href="variansanalys.html"><i class="fa fa-check"></i><b>9</b> Variansanalys</a>
<ul>
<li class="chapter" data-level="9.1" data-path="variansanalys.html"><a href="variansanalys.html#variansanalys.-en-faktor"><i class="fa fa-check"></i><b>9.1</b> Variansanalys. En faktor</a></li>
<li class="chapter" data-level="9.2" data-path="variansanalys.html"><a href="variansanalys.html#variansanalys.-en-faktor-med-block"><i class="fa fa-check"></i><b>9.2</b> Variansanalys. En faktor med block</a></li>
<li class="chapter" data-level="9.3" data-path="variansanalys.html"><a href="variansanalys.html#variansanalys.-två-faktorer-med-block"><i class="fa fa-check"></i><b>9.3</b> Variansanalys. Två faktorer med block</a></li>
<li class="chapter" data-level="9.4" data-path="variansanalys.html"><a href="variansanalys.html#övningar-4"><i class="fa fa-check"></i><b>9.4</b> Övningar</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html"><i class="fa fa-check"></i><b>10</b> Regression och korrelation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#regression"><i class="fa fa-check"></i><b>10.1</b> Regression</a></li>
<li class="chapter" data-level="10.2" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#korrelation"><i class="fa fa-check"></i><b>10.2</b> Korrelation</a></li>
<li class="chapter" data-level="10.3" data-path="regression-och-korrelation.html"><a href="regression-och-korrelation.html#övningar-5"><i class="fa fa-check"></i><b>10.3</b> Övningar</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R-anvisningar till <em>Grundläggande statistik</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sannolikhetsfördelningar-och-slumptal" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Kapitel 6</span> Sannolikhetsfördelningar och slumptal<a href="sannolikhetsfördelningar-och-slumptal.html#sannolikhetsfördelningar-och-slumptal" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="fördelningar" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Fördelningar<a href="sannolikhetsfördelningar-och-slumptal.html#fördelningar" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R kommer med en stor mängd funktioner för att beräkna sannolikheter ur kända sannolikhetsfördelningar såsom binomial- och normalfördelningen. För en lista på fördelningar täckta av grundpaketen i R kan man köra <code>?distributions</code>.</p>
<p>För en <em>kontinuerlig likformig fördelning</em> gäller att alla utfall mellan 0 och 1 är lika sannolika. Som exempel kan man tänka sig att man stoppar ett tidtagarur vid ett slumpmässigt tillfälle och tittar på utfallets decimaler - de kommer ge ett värde mellan 0 och 1 och det finns ingen anledning att tro att vissa värden är mer sannolika än andra. Täthetsfunktionen <span class="math inline">\(f(x)\)</span> kan beräknas genom <span class="math inline">\(dunif\)</span>, där <code>d</code> står för <em>density</em> (täthet) och <code>unif</code> anger en <em>uniform</em> fördelning. Fördelningens täthetsfunktion är 0 för värden på <span class="math inline">\(x\)</span> under 0 eller över 1, och däremellan är täthetsfunktionen 1.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dunif</span>(<span class="sc">-</span><span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dunif</span>(<span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dunif</span>(<span class="fl">1.1</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Fördelningsfunktionen anger sannolikheten för ett värde mindre än <span class="math inline">\(x\)</span>, <span class="math inline">\(F(x) = P(X \leq x)\)</span> och kan i R beräknas genom funktionen <span class="math inline">\(punif\)</span>, där <code>p</code> står för <em>probability</em>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">punif</span>(<span class="sc">-</span><span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">punif</span>(<span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## [1] 0.1</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">punif</span>(<span class="fl">1.1</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Fördelningsfunktionen för en likformig fördelning är för värden på <span class="math inline">\(x\)</span> under 0, 1 för värden på <span class="math inline">\(x\)</span> över 1, och däremellan lika med <span class="math inline">\(x\)</span>.</p>
<p>Täthetsfunktion och fördelningsfunktion kan illustreras med grafer. Funktionen <code>seq</code> används för att skapa en sekvens från ett värde till ett annat värde. Paketet <code>patchwork</code> används för att kombinera två grafer. Funktionen <code>tibble</code> används för att skapa ett <code>tibble</code>-objekt - funktionen fungerar likt <code>data.frame</code> i att kolumner anges som <code>namn = kolumnvärden</code>.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-1" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">to =</span> <span class="fl">1.5</span>, <span class="at">by =</span> <span class="fl">0.01</span>),</span>
<span id="cb106-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">f =</span> <span class="fu">dunif</span>(x)) <span class="sc">%&gt;%</span> </span>
<span id="cb106-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, f)) <span class="sc">+</span> </span>
<span id="cb106-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb106-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Täthetsfunktion, f(x)&quot;</span>)</span>
<span id="cb106-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-7"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-7" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">to =</span> <span class="fl">1.5</span>, <span class="at">by =</span> <span class="fl">0.01</span>),</span>
<span id="cb106-8"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">F =</span> <span class="fu">punif</span>(x)) <span class="sc">%&gt;%</span> </span>
<span id="cb106-9"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, F)) <span class="sc">+</span> </span>
<span id="cb106-10"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb106-11"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Fördelningsfunktion, F(x)&quot;</span>)</span>
<span id="cb106-12"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-13"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb106-14"><a href="sannolikhetsfördelningar-och-slumptal.html#cb106-14" aria-hidden="true" tabindex="-1"></a>g1 <span class="sc">+</span> g2</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-66-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Motsvarande funktioner för en normalfördelning ges av <code>dnorm</code> och <code>pnorm</code>. Medelvärde och standardavvikelse kan sättas genom argumenten <code>mean</code> och <code>sd</code>. Här ges ett exempel på en normalfördelning med medelvärdet 50 och standardavvikelse 3.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb107-1" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">40</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb107-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb107-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">f =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, f)) <span class="sc">+</span> </span>
<span id="cb107-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb107-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Täthetsfunktion, f(x)&quot;</span>)</span>
<span id="cb107-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="sannolikhetsfördelningar-och-slumptal.html#cb107-7" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">40</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb107-8"><a href="sannolikhetsfördelningar-och-slumptal.html#cb107-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">F =</span> <span class="fu">pnorm</span>(x, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-9"><a href="sannolikhetsfördelningar-och-slumptal.html#cb107-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, F)) <span class="sc">+</span> </span>
<span id="cb107-10"><a href="sannolikhetsfördelningar-och-slumptal.html#cb107-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb107-11"><a href="sannolikhetsfördelningar-och-slumptal.html#cb107-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Fördelningsfunktion, F(x)&quot;</span>)</span>
<span id="cb107-12"><a href="sannolikhetsfördelningar-och-slumptal.html#cb107-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-13"><a href="sannolikhetsfördelningar-och-slumptal.html#cb107-13" aria-hidden="true" tabindex="-1"></a>g1 <span class="sc">+</span> g2</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-67-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Fördelningsfunktionen anger sannolikheten att ett utfall ligger under värdet <span class="math inline">\(x\)</span>. Om man vill beräkna det omvända fallet - ett x-värde sådant att sannolikheten att ligga under det värdet är en viss sannolikhet <span class="math inline">\(p\)</span> - använder man <em>kvantilfunktionen</em>. Som exempel beräknas ett värde på x-axeln sådant att en fjärdedel ligger under det värdet i en normalfördelning med <span class="math inline">\(\mu = 50\)</span> och <span class="math inline">\(\sigma = 3\)</span>.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.25</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 47.97653</code></pre>
<p>Sannolikhetsfunktion och fördelningsfunktion kan även beräknas för diskreta fördelningar. Binomialfördelningen ges till exempel av <code>dbinom</code> och <code>pbinom</code> med argumenten <code>size</code> för parametern <span class="math inline">\(n\)</span> och <code>prob</code> för parametern <span class="math inline">\(p\)</span>. Här ges ett exempel på en binomialfördelning med <span class="math inline">\(n = 20\)</span> och <span class="math inline">\(p = 0.7\)</span>. Eftersom en diskret fördelning oftast illustreras med stapeldiagram ersätts <code>geom_line()</code> med <code>geom_bar(stat = "identity")</code>.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb110-1" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb110-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb110-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">f =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb110-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, f)) <span class="sc">+</span> </span>
<span id="cb110-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb110-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Sannolikhetsfunktion, f(x)&quot;</span>)</span>
<span id="cb110-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="sannolikhetsfördelningar-och-slumptal.html#cb110-7" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb110-8"><a href="sannolikhetsfördelningar-och-slumptal.html#cb110-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">F =</span> <span class="fu">pbinom</span>(x, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb110-9"><a href="sannolikhetsfördelningar-och-slumptal.html#cb110-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, F)) <span class="sc">+</span> </span>
<span id="cb110-10"><a href="sannolikhetsfördelningar-och-slumptal.html#cb110-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb110-11"><a href="sannolikhetsfördelningar-och-slumptal.html#cb110-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Fördelningsfunktion, F(x)&quot;</span>)</span>
<span id="cb110-12"><a href="sannolikhetsfördelningar-och-slumptal.html#cb110-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-13"><a href="sannolikhetsfördelningar-och-slumptal.html#cb110-13" aria-hidden="true" tabindex="-1"></a>g1 <span class="sc">+</span> g2</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-69-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Utöver sannolikhetsberäkningar har R funktioner för att skapa slumptal från en angiven fördelning. Dessa anges genom bokstaven <code>r</code> (för <em>random</em>) följt av fördelningens namn, t.ex. <code>rnorm</code> för normalfördelningen och <code>rbinom</code> för binomialfördelningen. I exemplet nedan dras tiotusen observationer från en normalfördelning. Histogrammet visar att slumptalen ungefär följer den teoretiska fördelningen (här utritad med funktionen <code>stat_function</code>).</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb111-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">3</span>))</span>
<span id="cb111-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb111-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span>..density..)) <span class="sc">+</span></span>
<span id="cb111-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">3</span>), </span>
<span id="cb111-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb111-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-70-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Argumentet <code>y = ..density..</code> anger att y-axeln ska vara i andelar, istället för antal.</p>
</div>
<div id="egna-funktioner" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Egna funktioner<a href="sannolikhetsfördelningar-och-slumptal.html#egna-funktioner" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Det är möjligt att definera egna funktioner genom konstruktionsfunktionen <code>function</code>. Ett enkelt exempel på en funktion som tar ett värde och ger det värdet plus 4:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb112-1" aria-hidden="true" tabindex="-1"></a>add_four <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb112-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="dv">4</span></span>
<span id="cb112-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb112-3" aria-hidden="true" tabindex="-1"></a>  y</span>
<span id="cb112-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb112-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">add_four</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<p>Här är <code>add_four</code> namnet på den funktion som skapas och <code>function(x)</code> anger att man skapar en funktion med ett ingångsvärde <code>x</code>. Stycket inom <code>{...}</code> är själva funktionsberäkning. I det här fallet skapar funktionen ett objekt <code>y</code> som ges av x plus 4, och därefter skrivs resultatet ut. Det som skrivs ut i funktionens sista rad blir funktionens output.</p>
<p>Funktioner kan ha mer än ett ingående värde, t.ex.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb114-1" aria-hidden="true" tabindex="-1"></a>add_two_numbers <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb114-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb114-2" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> x <span class="sc">+</span> y</span>
<span id="cb114-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb114-3" aria-hidden="true" tabindex="-1"></a>  res</span>
<span id="cb114-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb114-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="fu">add_two_numbers</span>(<span class="dv">15</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 18</code></pre>
<p>Ett ingångsvärde kan ges ett grundläge genom att ange det som ett argument i funktionen, t.ex.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb116-1" aria-hidden="true" tabindex="-1"></a>add_two_numbers <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">y =</span> <span class="dv">3</span>){</span>
<span id="cb116-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb116-2" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> x <span class="sc">+</span> y</span>
<span id="cb116-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb116-3" aria-hidden="true" tabindex="-1"></a>  res</span>
<span id="cb116-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb116-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb116-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="fu">add_two_numbers</span>(<span class="dv">15</span>)</span></code></pre></div>
<pre><code>## [1] 18</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">add_two_numbers</span>(<span class="dv">15</span>, <span class="dv">12</span>)</span></code></pre></div>
<pre><code>## [1] 27</code></pre>
<p>Om inget värde anges för det andra ingåendevärdet (y) sätts det värdet till 3, eftersom det anges i definitionen av funktionen.</p>
</div>
<div id="simuleringar" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Simuleringar<a href="sannolikhetsfördelningar-och-slumptal.html#simuleringar" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Med hjälp av egna funktioner och slumptal kan man utforska många grundläggande statistiska resultat. Teoretiska resultat säger till exempel att om en slumpvariabel <span class="math inline">\(X\)</span> har standardavvikelsen <span class="math inline">\(\sigma\)</span>, så har ett medelvärde av <span class="math inline">\(n\)</span> observationer av <span class="math inline">\(X\)</span> standardavvikelsen <span class="math inline">\(\sigma / \sqrt n\)</span>. För att undersöka detta skapas en funktion som för ett angivet värde på <span class="math inline">\(n\)</span> ger ett medelvärde av <span class="math inline">\(n\)</span> slumptal.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb120-1" aria-hidden="true" tabindex="-1"></a>mean_of_n_obs <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">1</span>){</span>
<span id="cb120-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb120-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb120-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(x)</span>
<span id="cb120-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb120-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Funktionen tar ingångsvärdet n, simulerar n stycken slumptal från en normalfördelning med medelvärde 0 och standardavvikelse 1, och ger ut medelvärdet av de slumptalen.</p>
<p>Funktionen <code>replicate</code> kan användas för att köra en funktion upprepade gånger - <code>replicate(100, mean_of_n_obs(n = 10))</code> upprepar den definerade funktionen 100 gånger och ger alltså 100 stycken medelvärden där varje medelvärde beräknas från 10 observationer.</p>
<p>Eftersom standardavvikelsen i den ursprungliga dragningen var 1 (<span class="math inline">\(\sigma = 1\)</span>) bör standardavvikelsen i ett medelvärde av 16 observationer vara 0.25 (<span class="math inline">\(\sigma / \sqrt{16} = 1 / 4 = 0.25\)</span>). Det testas genom att beräkna tiotusen medelvärden (genom <code>replicate</code>) och beräkna standardavvikelsen i den serien av medelvärden.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb121-1" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="fu">mean_of_n_obs</span>(<span class="at">n =</span> <span class="dv">16</span>))</span>
<span id="cb121-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(means)</span></code></pre></div>
<pre><code>## [1] 0.2490357</code></pre>
<p>Detta kan uppepas för andra stickprovsstorlekar - ett stickprov om hundra observationer bör ge ett värde kring 0.1 (eftersom <span class="math inline">\(\sigma / \sqrt{100} = 1 / 10 = 0.1\)</span>).</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb123-1" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="fu">mean_of_n_obs</span>(<span class="at">n =</span> <span class="dv">100</span>))</span>
<span id="cb123-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(means)</span></code></pre></div>
<pre><code>## [1] 0.1005043</code></pre>
<p>Sannolikhetsteorin viktigaste resultat är <em>centrala gränsvärdesatsen</em>, som säger att medelvärden av flera lika slumpvariabler är ungefärligt normalfördelade även om den ursprungliga slumpvariabeln inte är det. Detta kan illustreras genom att dra slumptal från valfri fördelning, beräkna medelvärden av de slumptalen, och sedan titta på fördelningen för de medelvärdena. Ett första steg kan vara att skriva en funktion som drar slumptal och beräknar ett medelvärde.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb125-1" aria-hidden="true" tabindex="-1"></a>draw_random_calculate_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb125-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb125-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10</span>)</span>
<span id="cb125-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(x)</span>
<span id="cb125-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb125-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Den ursprungliga fördelningen är här en likformig fördelning och stickprovsstorleken är 10.</p>
<p>Funktionen <code>replicate</code> används för att dra tiotusen medelvärden och <code>ggplot</code> används för att skapa ett histogram över medelvärdena.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb126-1" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="fu">draw_random_calculate_mean</span>()))</span>
<span id="cb126-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(means, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb126-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">60</span>)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-78-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Medelvärdena följer en ungefärlig normalfördelning trots att den ursprungliga variabeln följer en likformig fördelning.</p>

</div>
<div id="övningar-1" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Övningar<a href="sannolikhetsfördelningar-och-slumptal.html#övningar-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="exercise">
<p><span id="exr:unlabeled-div-15" class="exercise"><strong>Övning 6.1  (Binomial grobarhet) </strong></span>I ett försöks sätts 10 frön med en grobarhetssannolikhet om 60 procent. Antal frön som gror följer då en binomialfördelning med <span class="math inline">\(N = 10\)</span> och <span class="math inline">\(p = 0.6\)</span>, vilket kan skrivas <span class="math inline">\(X \sim Bin(10, 0.6)\)</span>.</p>
<p>a. Vad är sannolikheten att få exakt 6 groende frön, <span class="math inline">\(P(X = 6)\)</span>?</p>
<p>b. Vad är sannolikheten att få högst 6 groende frön, <span class="math inline">\(P(X \leq 6)\)</span>?</p>
<p>c. Beräkna slumpvariabelns <em>fördelningsfunktion</em>.</p>
<p>d. Illustrera sannolikheterna från (c).</p>
<p>Ledning: <code>dbinom</code> och <code>pbinom</code> kan beräkna sannolikheter från en binomialfördelning.</p>
</div>
<div class="hypothesis">
<p><span id="hyp:unlabeled-div-16" class="hypothesis"><strong>Lösningsförslag 6.1  (Binomial grobarhet) </strong></span>Uppgiften kan lösas genom att ta fram sannolikheter med <code>dbinom</code> och <code>pbinom</code> med argumenten <code>size = 10</code> för tio frön och <code>prob = 0.6</code> för en grobarhet på 0.6</p>
<p>a.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">6</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<pre><code>## [1] 0.2508227</code></pre>
<p>b.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<pre><code>## [1] 0.6177194</code></pre>
<p>c.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb131-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb131-2" aria-hidden="true" tabindex="-1"></a>       Fördelningsfunktion <span class="ot">=</span> <span class="fu">pbinom</span>(x, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.6</span>))</span></code></pre></div>
<pre><code>## # A tibble: 11 × 2
##        x Fördelningsfunktion
##    &lt;int&gt;               &lt;dbl&gt;
##  1     0            0.000105
##  2     1            0.00168 
##  3     2            0.0123  
##  4     3            0.0548  
##  5     4            0.166   
##  6     5            0.367   
##  7     6            0.618   
##  8     7            0.833   
##  9     8            0.954   
## 10     9            0.994   
## 11    10            1</code></pre>
<p>d.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb133-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb133-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb133-2" aria-hidden="true" tabindex="-1"></a>       Fördelningsfunktion <span class="ot">=</span> <span class="fu">pbinom</span>(x, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.6</span>),</span>
<span id="cb133-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb133-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">Sannolikhetsfunktion =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.6</span>))</span>
<span id="cb133-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb133-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">y =</span> Fördelningsfunktion), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, </span>
<span id="cb133-7"><a href="sannolikhetsfördelningar-och-slumptal.html#cb133-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;pink&quot;</span>, <span class="at">col =</span> <span class="st">&quot;hotpink&quot;</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb133-8"><a href="sannolikhetsfördelningar-och-slumptal.html#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, </span>
<span id="cb133-9"><a href="sannolikhetsfördelningar-och-slumptal.html#cb133-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> Sannolikhetsfunktion, <span class="at">yend =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb133-10"><a href="sannolikhetsfördelningar-och-slumptal.html#cb133-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb133-11"><a href="sannolikhetsfördelningar-och-slumptal.html#cb133-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;purple&quot;</span>), </span>
<span id="cb133-12"><a href="sannolikhetsfördelningar-och-slumptal.html#cb133-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-83-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Illustration av fördelningsfunktionen (som breda staplar) med sannolikhetsfunktionen inritad som smala streck. Exempel på argument för val av färger för geom och tema. Sannolikheten i (a) (exakt 6 groende frön) ges av det svarta strecket vid 6 och sannolikheten i (b) (högst 6 groende frön) ges av den breda stapeln vid 6.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-17" class="exercise"><strong>Övning 6.2  (Poissonfördelad klöver) </strong></span>Antalet fyrklöver på en slumpmässigt vald kvadratmeter från en gräsmatta är poissonfördelad med väntevärde 1 per <span class="math inline">\(m^2\)</span>.</p>
<p>a. Hur stor är sannolikheten att en slumpmässigt vald <span class="math inline">\(m^2\)</span> innehåller minst en fyrklöver, <span class="math inline">\(P(X \geq 1)\)</span>? Exakt en fyrklöver, <span class="math inline">\(P(X = 1)\)</span>?</p>
<p>b. Hur stor är sannolikheten att en slumpmässigt vald yta om 10 kvadratmeter innehåller exakt 10 fyrklöver?</p>
<p>Ledning: Summan av n stycken likadana poissonfördelade variabler är en poissonfördelad variabel med väntevärde givet av n gånger väntevärdet för den enskilda variabeln.</p>
<p>(Från Olsson, <em>Biometri</em>.)</p>
</div>
<div class="hypothesis">
<p><span id="hyp:unlabeled-div-18" class="hypothesis"><strong>Lösningsförslag 6.2  (Poissonfördelad klöver) </strong></span>Sannolikheter för en poissonfördelning kan tas fram med <code>dpois</code> för sannolikhetsfunktionen eller <code>ppois</code> för fördelningsfunktionen.</p>
<p>a. Antal klöver på en kvadratmeter följer en poissonfördelning med <span class="math inline">\(\lambda = 1\)</span>. Sannolikheten för minst en fyrklöver kan beräknas genom ett minus sannolikheten för noll fyrklöver (utfallet noll fyrklöver är ett <em>komplement</em> till utfallet en eller fler fyrklöver).</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P(X &gt;= 1) = 1 - P(X &lt;= 0)</span></span>
<span id="cb134-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">ppois</span>(<span class="dv">0</span>, <span class="at">lambda =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.6321206</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P(X = 1)</span></span>
<span id="cb136-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">1</span>, <span class="at">lambda =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 0.3678794</code></pre>
<p>b. Summan av poissonfördelade variabler är poissonfördelad med parametern <span class="math inline">\(\lambda\)</span> given av summan av de ursprungliga variablernas parametervärden. Tio kvadratmeter kan ses som summan av tio stycken observationer av en kvadratmeter. Antal klöver på tio kvadratmeter bör därmed följa en poissonfördelning med <span class="math inline">\(\lambda = 10\)</span>.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Y ~ Po(lambda = 10)</span></span>
<span id="cb138-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dpois</span>(<span class="dv">10</span>, <span class="at">lambda =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## [1] 0.12511</code></pre>
<p>Ungefär <span class="math inline">\(12.5\)</span> procent.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-19" class="exercise"><strong>Övning 6.3  (Sannolikheter från en normalfördelning) </strong></span>Slumpvariabeln <span class="math inline">\(X\)</span> är normalfördelad med medelvärde <span class="math inline">\(2\)</span> och varians <span class="math inline">\(9\)</span>. Beräkna följande</p>
<p>a. <span class="math inline">\(P(X &gt; 2.75)\)</span></p>
<p>b. <span class="math inline">\(P(X \leq 2.75)\)</span></p>
<p>c. <span class="math inline">\(P(X &gt; 2.50)\)</span></p>
<p>d. <span class="math inline">\(P(2.30 &lt; X &lt; 2.45)\)</span></p>
<p>e. <span class="math inline">\(P(X &gt; -0.02)\)</span></p>
<p>f. <span class="math inline">\(P(-0.02 &lt; X &lt; 1.80)\)</span></p>
<p>g. Bestäm värdet på x som uppfyller att <span class="math inline">\(P(X &lt; x) = F(x) = 0.95\)</span>.</p>
<p>(Från Olsson, <em>Biometri</em>. Samma som instuderingsuppgift 22.)</p>
</div>
<div class="hypothesis">
<p><span id="hyp:unlabeled-div-20" class="hypothesis"><strong>Lösningsförslag 6.3  (Sannolikheter från en normalfördelning) </strong></span>Sannolikheter från normalfördelningen kan tas fram med <code>pnorm</code>.</p>
<p>a. Notera att <em>variansen</em> <span class="math inline">\(\sigma^2\)</span> är <span class="math inline">\(9\)</span> och att standardavvikelsen <span class="math inline">\(\sigma\)</span> därmed är <span class="math inline">\(3\)</span>. Funktionen <code>pnorm</code> ger sannolikheten att ligga <em>under</em> ett givet x-värde. För att beräkna <span class="math inline">\(P(X &gt; 2.75)\)</span> kan ta ett minus <span class="math inline">\(P(X &lt; 2.75)\)</span>.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fl">2.75</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.4012937</code></pre>
<p>b. Direkt tillämpning av <code>pnorm</code>.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">2.75</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.5987063</code></pre>
<p>c. Likt (a).</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fl">2.5</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.4338162</code></pre>
<p>d. För att beräkna sannolikheten att ligga mellan två värden kan man ta skillnaden mellan två värden framräknade med <code>pnorm</code>.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">2.45</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fl">2.30</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.01978986</code></pre>
<p>Om man vill illustrera en sannolikhet från en normalfördelning kan man beräkna normalfördelningskurvan med <code>dnorm</code> och sedan färglägga en sektion genom ett <code>geom_ribbon</code> på filtrerad data. Exempel för (d).</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb148-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">7</span>, <span class="dv">11</span>, <span class="fl">0.01</span>),</span>
<span id="cb148-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb148-2" aria-hidden="true" tabindex="-1"></a>              Täthetsfunktion <span class="ot">=</span> <span class="fu">dnorm</span>(x, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb148-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(x, Täthetsfunktion)) <span class="sc">+</span></span>
<span id="cb148-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb148-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb148-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb148-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> Täthetsfunktion, <span class="at">ymin =</span> <span class="dv">0</span>), </span>
<span id="cb148-7"><a href="sannolikhetsfördelningar-och-slumptal.html#cb148-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">&gt;</span> <span class="fl">2.30</span> <span class="sc">&amp;</span> x <span class="sc">&lt;</span> <span class="fl">2.45</span>),</span>
<span id="cb148-8"><a href="sannolikhetsfördelningar-och-slumptal.html#cb148-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;turquoise&quot;</span>)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-90-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Den turkosa ytan motsvarar sannolikheten att <span class="math inline">\(X\)</span> ger ett utfall mellan <span class="math inline">\(2.30\)</span> och <span class="math inline">\(2.45\)</span>, sannolikheten uträknad i (d).</p>
<p>e.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">0.02</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.7496324</code></pre>
<p>f.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.8</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">0.02</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.2230559</code></pre>
<p>g. Det sökta värdet är kvantil <span class="math inline">\(0.95\)</span>, ett värde sådant att 95 procent ligger under det värdet. Med en normalfördelning med medelvärde 2 och standardavvikelse 3 kan det tas fram med följande.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.95</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="co"># 2 och 3 anger medel 2 och standardavvikelse 3</span></span></code></pre></div>
<pre><code>## [1] 6.934561</code></pre>
<p>Tolkningen är att i en normal <span class="math inline">\(N(\mu = 2, \sigma^2 = 9)\)</span> ligger 95 procent av ytan under <span class="math inline">\(6.9346\)</span>.</p>
<p>En illustration kan skapas med en datatabell med värden från fördelningens täthetsfunktion och <code>geom_ribbon</code>.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb155-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">7</span>, <span class="dv">11</span>, <span class="fl">0.01</span>),</span>
<span id="cb155-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb155-2" aria-hidden="true" tabindex="-1"></a>              Täthetsfunktion <span class="ot">=</span> <span class="fu">dnorm</span>(x, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb155-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb155-4" aria-hidden="true" tabindex="-1"></a>q_95 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.95</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb155-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb155-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(x, Täthetsfunktion)) <span class="sc">+</span></span>
<span id="cb155-7"><a href="sannolikhetsfördelningar-och-slumptal.html#cb155-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb155-8"><a href="sannolikhetsfördelningar-och-slumptal.html#cb155-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> Täthetsfunktion, <span class="at">ymin =</span> <span class="dv">0</span>), </span>
<span id="cb155-9"><a href="sannolikhetsfördelningar-och-slumptal.html#cb155-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x <span class="sc">&lt;</span> q_95),</span>
<span id="cb155-10"><a href="sannolikhetsfördelningar-och-slumptal.html#cb155-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;turquoise&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb155-11"><a href="sannolikhetsfördelningar-och-slumptal.html#cb155-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="fu">round</span>(q_95, <span class="dv">3</span>)))</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-94-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>95 procent av ytan ligger under 6.935.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-21" class="exercise"><strong>Övning 6.4  (Relativ frekvens) </strong></span>Säg att man kastar ett häftstift och att sannolikheten att stiftet stannar med spetsen upp är 0.66. Simulera tusen häftstiftskast och beräkna den relativa frekvensen häftstiften hamnat med spetsen uppåt. Den relativa frekvensen för en serie värden ges av antalet positiva utfall delat på antalet kast för varje kast. Den relativa frekvensen efter 35 kast är till exempel antalet positiva utfall bland de 35, delat på 35.
Illustrera med ett linjediagram.</p>
<p>Ledning: tusen kast kan simuleras med <code>rbin(1000, 1, 0.66)</code>, vilket skapar tusen slumptal från en binomialfördelning där <span class="math inline">\(n = 1\)</span> och <span class="math inline">\(p = 0.67\)</span>.</p>
</div>
<div class="hypothesis">
<p><span id="hyp:unlabeled-div-22" class="hypothesis"><strong>Lösningsförslag 6.4  (Relativ frekvens) </strong></span>För att beräkna och illustrera den relativa frekvensen skapas en <code>tibble</code> där den första kolumnen anger antalet kast vid varje steg, det vill säga en kolumn som anger ett till tusen. Därefter dras tusen slumptal enligt ledningen ovan. Därefter beräknas den <em>kumulativa summan</em> - antalet positiva utfall upp till det kast som anges för raden. Och slutligen beräknas den relativa frekvensen genom att ta den kumulativa summan och dela med antalet kast.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb156-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Kast =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>,</span>
<span id="cb156-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb156-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">Utfall =</span> <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="dv">1</span>, <span class="fl">0.67</span>),</span>
<span id="cb156-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb156-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">Antal_spets_upp =</span> <span class="fu">cumsum</span>(Utfall),</span>
<span id="cb156-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb156-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">Relativ_frekvens =</span> Antal_spets_upp <span class="sc">/</span> Kast)</span>
<span id="cb156-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb156-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb156-6" aria-hidden="true" tabindex="-1"></a>dat</span></code></pre></div>
<pre><code>## # A tibble: 1,000 × 4
##     Kast Utfall Antal_spets_upp Relativ_frekvens
##    &lt;int&gt;  &lt;int&gt;           &lt;int&gt;            &lt;dbl&gt;
##  1     1      1               1            1    
##  2     2      0               1            0.5  
##  3     3      1               2            0.667
##  4     4      1               3            0.75 
##  5     5      1               4            0.8  
##  6     6      1               5            0.833
##  7     7      1               6            0.857
##  8     8      0               6            0.75 
##  9     9      1               7            0.778
## 10    10      1               8            0.8  
## # … with 990 more rows</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(Kast, Relativ_frekvens)) <span class="sc">+</span></span>
<span id="cb158-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb158-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.66</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb158-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-95-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Den relativa frekvensen stabiliseras efter ett par hundra kast.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-23" class="exercise"><strong>Övning 6.5  (Jämförelse mellan binomial och poisson) </strong></span>Poissonfördelning kan ses som en approximation av en binomialfördelning när <span class="math inline">\(n\)</span> är stort och <span class="math inline">\(p\)</span> är litet. Poissonfördelningens parameter <span class="math inline">\(\lambda\)</span> sätts vid approximation till binomialfördelningens populationsmedelvärde <span class="math inline">\(np\)</span>.</p>
<p>Ta som exempel en binomialfördelning men <span class="math inline">\(n = 10\)</span> och <span class="math inline">\(p = 0.1\)</span>; dess väntevärde är <span class="math inline">\(10 \cdot 0.1 = 1\)</span>.
Beräkna sannolikheter från binomialfördelningen och motsvarande poissonfördelning. Jämför utfallen och illustrera med en passande graf.</p>
</div>
<div class="hypothesis">
<p><span id="hyp:unlabeled-div-24" class="hypothesis"><strong>Lösningsförslag 6.5  (Jämförelse mellan binomial och poisson) </strong></span>Fördelningen för binomial och poisson kan tas fram med <code>dbinom</code> respektive <code>dpois</code>.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb159-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb159-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb159-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">Binomial =</span> <span class="fu">dbinom</span>(x, <span class="dv">10</span>, <span class="fl">0.1</span>),</span>
<span id="cb159-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb159-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">Poisson =</span> <span class="fu">dpois</span>(x, <span class="dv">1</span>),</span>
<span id="cb159-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb159-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">Differens =</span> Binomial <span class="sc">-</span> Poisson)</span>
<span id="cb159-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb159-5" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 11 × 4
##        x Binomial Poisson Differens
##    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
##  1     0    0.349   0.368    -0.019
##  2     1    0.387   0.368     0.02 
##  3     2    0.194   0.184     0.01 
##  4     3    0.057   0.061    -0.004
##  5     4    0.011   0.015    -0.004
##  6     5    0.001   0.003    -0.002
##  7     6    0       0.001     0    
##  8     7    0       0         0    
##  9     8    0       0         0    
## 10     9    0       0         0    
## 11    10    0       0         0</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb161-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Binomial), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb161-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> Poisson), <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-96-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Fördelningarna är ganska lika. Relativt binomialen överskattar poissonfördelningen sannolikheten att få exakt 0 och överskattar sannolikheten att få exakt 1.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-25" class="exercise"><strong>Övning 6.6  (Jämförelse mellan binomial och normal) </strong></span>En av många orsaker till att normalfördelningen förekommer i tillämpningar är att både binomialfördelningen och poissonfördelningen kan approximeras med en normalfördelning om populationsmedelvärdet är stort. För att se exempel på detta kan man jämföra en binomialfördelning med en normalfördelning. Skapa en graf för en binomialfördelning med n = 100 och p = 0.4 med en överliggande normalfördelning med samma populationsmedelvärde och -varians, dvs. populationsmedelvärdet <span class="math inline">\(\mu = np = 100 \cdot 0.4 = 40\)</span> och populationsvariansen <span class="math inline">\(\sigma^2 = n\cdot p \cdot (1-p) = 100 \cdot 0.4 \cdot 0.6 = 24\)</span>.</p>
</div>
<div class="hypothesis">
<p><span id="hyp:unlabeled-div-26" class="hypothesis"><strong>Lösningsförslag 6.6  (Jämförelse mellan binomial och normal) </strong></span>Funktionerna <code>dbinom</code> och <code>dnorm</code> kan användas för att ta fram funktionsvärden från binomial- och normalfördelning. Dessa kan sedan plottas i en ggplot genom <code>geom_segment</code> för binomialen och <code>geom_line</code> för den kontinuerliga normalfördelningen.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb162-1" aria-hidden="true" tabindex="-1"></a>dat_bin <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>,</span>
<span id="cb162-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb162-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Snlh =</span> <span class="fu">dbinom</span>(x, <span class="dv">100</span>, <span class="fl">0.4</span>))</span>
<span id="cb162-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb162-3" aria-hidden="true" tabindex="-1"></a>dat_norm <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="fl">0.1</span>),</span>
<span id="cb162-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb162-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Snlh =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">40</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">24</span>)))</span>
<span id="cb162-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb162-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb162-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb162-7"><a href="sannolikhetsfördelningar-och-slumptal.html#cb162-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, Snlh), <span class="at">data =</span> dat_norm, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb162-8"><a href="sannolikhetsfördelningar-och-slumptal.html#cb162-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">xend =</span> x, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span>Snlh), </span>
<span id="cb162-9"><a href="sannolikhetsfördelningar-och-slumptal.html#cb162-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> dat_bin, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>) </span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-97-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Normalkurvan (blå kontinuerlig linje) följer binomalfördelningen (röda staplar). Man kan också jämföra specifika sannolikheter, till exempel</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exakt 35 i binomialen</span></span>
<span id="cb163-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">35</span>, <span class="dv">100</span>, <span class="fl">0.4</span>) <span class="co"># 0.0491</span></span></code></pre></div>
<pre><code>## [1] 0.04913282</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mellan 34.5 och 35.5 i normalen</span></span>
<span id="cb165-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">35.5</span>, <span class="dv">40</span>, <span class="fu">sqrt</span>(<span class="dv">24</span>)) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fl">34.5</span>, <span class="dv">40</span>, <span class="fu">sqrt</span>(<span class="dv">24</span>)) <span class="co"># 0.0483</span></span></code></pre></div>
<pre><code>## [1] 0.04837712</code></pre>
<p>Sannolikheten för exakt 35 i binomialen ligger nära sannolikheten för utfall mellan 34.5 och 35.5 i normalfördelningen.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-27" class="exercise"><strong>Övning 6.7  (Log-normal fördelning) </strong></span>Ett exempel på en fördelning som är kontinuerlig, men inte normal, är en log-normal fördelning. En log-normal fördelning defineras av att den ger en normalfördelning efter att den logaritmeras - den är exponentialen av normalfördelningen. Dra 10000 slumptal från en log-normal fördelning (funktionen <code>rlnorm</code>) och illustrera med ett histogram. Ta logaritmen av datan och skapa histogrammet på nytt.</p>
</div>
<div class="hypothesis">
<p><span id="hyp:unlabeled-div-28" class="hypothesis"><strong>Lösningsförslag 6.7  (Log-normal fördelning) </strong></span>Funktionen <code>rlnorm</code> skapar slumptal från en log-normal fördelning. Två separata grafer plottar histogram över slumptalen och slumptalen efter log-transform.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb167-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Slumptal =</span> <span class="fu">rlnorm</span>(<span class="dv">10000</span>))</span>
<span id="cb167-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb167-3" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(Slumptal)) <span class="sc">+</span> </span>
<span id="cb167-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb167-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Log-normal&quot;</span>)</span>
<span id="cb167-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb167-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb167-7"><a href="sannolikhetsfördelningar-och-slumptal.html#cb167-7" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="fu">log</span>(Slumptal))) <span class="sc">+</span> </span>
<span id="cb167-8"><a href="sannolikhetsfördelningar-och-slumptal.html#cb167-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb167-9"><a href="sannolikhetsfördelningar-och-slumptal.html#cb167-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Log av log-normal&quot;</span>)</span>
<span id="cb167-10"><a href="sannolikhetsfördelningar-och-slumptal.html#cb167-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-11"><a href="sannolikhetsfördelningar-och-slumptal.html#cb167-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb167-12"><a href="sannolikhetsfördelningar-och-slumptal.html#cb167-12" aria-hidden="true" tabindex="-1"></a>g1 <span class="sc">+</span> g2</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-99-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-29" class="exercise"><strong>Övning 6.8  (Centrala gränsvärdesatsen) </strong></span>Centrala gränsvärdesatsen ger att summor (och medelvärden) av flera likadana slumpvariabler följer en ungefärlig normalfördelning. Skriv en funktion som drar 10 observation från en log-normal fördelning och beräknar ett medelvärde. Dra 10000 upprepningar från den fördelningen och se om medelvärdena följer en normalfördelning. Gör samma sak men skriv funktionen så att den drar 1000 observationer och tar ett medelvärde.</p>
<p>Se anvisningarna för ett liknande exempel. Observera att detta är en svårare uppgift.</p>
</div>
<div class="hypothesis">
<p><span id="hyp:unlabeled-div-30" class="hypothesis"><strong>Lösningsförslag 6.8  (Centrala gränsvärdesatsen) </strong></span>En funktion som tar medelvärdet av tio observation skapas. Tiotusen sådana medelvärden beräknas och dessa illustreras med ett histogram.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb168-1" aria-hidden="true" tabindex="-1"></a>mean_of_ten <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb168-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb168-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">10</span>)</span>
<span id="cb168-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(x)</span>
<span id="cb168-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb168-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb168-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb168-6" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="fu">mean_of_ten</span>())</span>
<span id="cb168-7"><a href="sannolikhetsfördelningar-och-slumptal.html#cb168-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-8"><a href="sannolikhetsfördelningar-och-slumptal.html#cb168-8" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Mean_values =</span> means)</span>
<span id="cb168-9"><a href="sannolikhetsfördelningar-och-slumptal.html#cb168-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-10"><a href="sannolikhetsfördelningar-och-slumptal.html#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(Mean_values)) <span class="sc">+</span></span>
<span id="cb168-11"><a href="sannolikhetsfördelningar-och-slumptal.html#cb168-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">60</span>)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-100-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Histogrammet visar en klar skevhet.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb169-1" aria-hidden="true" tabindex="-1"></a>mean_of_thousand <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb169-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb169-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb169-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(x)</span>
<span id="cb169-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb169-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb169-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb169-6" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="fu">mean_of_thousand</span>())</span>
<span id="cb169-7"><a href="sannolikhetsfördelningar-och-slumptal.html#cb169-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-8"><a href="sannolikhetsfördelningar-och-slumptal.html#cb169-8" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Mean_values =</span> means)</span>
<span id="cb169-9"><a href="sannolikhetsfördelningar-och-slumptal.html#cb169-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-10"><a href="sannolikhetsfördelningar-och-slumptal.html#cb169-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(Mean_values)) <span class="sc">+</span></span>
<span id="cb169-11"><a href="sannolikhetsfördelningar-och-slumptal.html#cb169-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">60</span>)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-101-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Histogrammet ligger närmare en typisk normalfördelning.</p>
</div>
<div class="exercise">
<p><span id="exr:unlabeled-div-31" class="exercise"><strong>Övning 6.9  (Multiplicera med två eller addera två) </strong></span>I en övningsuppsgift väcks frågan om det finns någon skillnad mellan att ta utfallet av en slumpvariabel och multiplicera med två, och att addera två slumpvariabler. Ta som exempel tre slumpvariabler <span class="math inline">\(X_1, X_2, X_3\)</span> och låt dem alla följa en binomialfördelning med <span class="math inline">\(n = 100\)</span> och <span class="math inline">\(p = 0.8\)</span>. Dra 10000 slumptal från respektive fördelning, beräkna <span class="math inline">\(2 \cdot X_1\)</span> och <span class="math inline">\(X_2 + X_3\)</span> och illustrera dessa beräknade variabler. Beräkna också väntevärde och standardavvikelse från de beräknade variablerna.</p>
</div>
<div class="hypothesis">
<p><span id="hyp:unlabeled-div-32" class="hypothesis"><strong>Lösningsförslag 6.9  (Multiplicera med två eller addera två) </strong></span>Tre variabler med slumptal konstrueras med <code>rbinom</code>. Därefter skapas två nya variabler, en genom summan av två av slumpvariablerna och en som den tredje slumpvariabeln multiplicerad med 2.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb170-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X1 =</span> <span class="fu">rbinom</span>(<span class="dv">10000</span>, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">prob =</span> <span class="fl">0.8</span>),</span>
<span id="cb170-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb170-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">X2 =</span> <span class="fu">rbinom</span>(<span class="dv">10000</span>, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">prob =</span> <span class="fl">0.8</span>),</span>
<span id="cb170-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb170-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">X3 =</span> <span class="fu">rbinom</span>(<span class="dv">10000</span>, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">prob =</span> <span class="fl">0.8</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb170-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Mult_by_2 =</span> <span class="dv">2</span> <span class="sc">*</span> X1,</span>
<span id="cb170-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb170-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Sum_of_two =</span> X2 <span class="sc">+</span> X3)</span>
<span id="cb170-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb170-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-7"><a href="sannolikhetsfördelningar-och-slumptal.html#cb170-7" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb170-8"><a href="sannolikhetsfördelningar-och-slumptal.html#cb170-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(mean)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##      X1    X2    X3 Mult_by_2 Sum_of_two
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1  80.1  80.1  80.0      160.       160.</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb172-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb172-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb172-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(sd)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##      X1    X2    X3 Mult_by_2 Sum_of_two
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1  4.01  3.98  3.99      8.03       5.63</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="sannolikhetsfördelningar-och-slumptal.html#cb174-1" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb174-2"><a href="sannolikhetsfördelningar-och-slumptal.html#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Mult_by_2, Sum_of_two) <span class="sc">%&gt;%</span> </span>
<span id="cb174-3"><a href="sannolikhetsfördelningar-och-slumptal.html#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb174-4"><a href="sannolikhetsfördelningar-och-slumptal.html#cb174-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="at">fill =</span> name)) <span class="sc">+</span></span>
<span id="cb174-5"><a href="sannolikhetsfördelningar-och-slumptal.html#cb174-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb174-6"><a href="sannolikhetsfördelningar-och-slumptal.html#cb174-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name)</span></code></pre></div>
<p><img src="R-anvisningar_files/figure-html/unnamed-chunk-102-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Stapeldiagrammet för fallet med en variabel multiplicerad med två ger högre staplar och större spridning än stapeldiagrammet med två summerade variabler. Diagrammet visar också hur vissa utfall inte kan inträffa i fallet med multiplikation, eftersom bara jämna utfall kan inträffa. Intuitivt kan man förstå den mindre spridningen för två summerade variabler med att ovanligt låga eller höga värden ofta kommer kvittas ut mot ett <em>vanligt</em> värde.</p>
<p>Skillnaden märks också i beräkning av standardavvikelse. Den ursprungliga variabeln har en varians på <span class="math inline">\(np(1-p) = 100 \cdot 0.8 \cdot 0.2 = 16\)</span> och därmed en standardavvikelse på<span class="math inline">\(\sqrt{16} = 4\)</span>. Multiplikation med två ger en slumpvariabel med den dubbla standardavvikelsen, alltså 8, medan addition av två likadana slumpvariabler ger en lägre standardavvikelse. För summor gäller att <em>variansen av summan är summan av varianserna</em> (detta antar dock oberoende slumpvariabler) - här fås alltså att variansen av summan är <span class="math inline">\(16+16=32\)</span> och att standardavvikelsen är <span class="math inline">\(\sqrt{32} = 5.6569\)</span>. Värdet i datan kommer förstås avvika något från den teoretiska beräkningen, eftersom det är slumptal.</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="beskrivande-statistik.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ett-stickprov.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "sepia",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-anvisningar.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
